<script>
  // YEAR
  document.getElementById("year").textContent = new Date().getFullYear();

  // TRANSLATIONS  (deixa essa parte exatamente como já está no teu arquivo)

  // ... (toda a parte de translations e setLanguage aqui em cima permanece igual)

  // Inicializa em português
  setLanguage("pt");

  // PREÇOS – VERSÃO NOVA (DEXSCREENER API ATUAL)
  async function fetchPLHPPrice() {
    // novo endpoint oficial
    const apiUrl =
      "https://api.dexscreener.com/token-pairs/v1/bsc/0x69575D9877822277539355ae8B97b5D5dee1313F";

    try {
      const res = await fetch(apiUrl);
      if (!res.ok) throw new Error("Erro ao buscar preço");
      const data = await res.json();

      // token-pairs/v1 retorna um ARRAY de pares
      if (!Array.isArray(data) || !data.length) {
        throw new Error("Par não encontrado");
      }

      const pair = data[0];

      const priceNative = pair.priceNative;
      const priceUsd = pair.priceUsd;
      const liquidityUsd = pair.liquidity?.usd;
      const volume24hUsd = pair.volume?.h24;

      const elNative = document.getElementById("price-native");
      const elUsd = document.getElementById("price-usd");
      const elLiq = document.getElementById("liquidity-usd");
      const elVol = document.getElementById("volume-usd");
      const elUpdated = document.getElementById("price-updated");

      if (!elNative || !elUsd) return;

      elNative.textContent = priceNative ? priceNative + " BNB" : "-";

      elUsd.textContent = priceUsd
        ? "$" + Number(priceUsd).toFixed(8)
        : "-";

      elLiq.textContent = liquidityUsd
        ? "$" +
          Number(liquidityUsd).toLocaleString("en-US", {
            maximumFractionDigits: 0
          })
        : "-";

      elVol.textContent = volume24hUsd
        ? "$" +
          Number(volume24hUsd).toLocaleString("en-US", {
            maximumFractionDigits: 0
          })
        : "-";

      const now = new Date();
      const currentLang = document
        .querySelector(".btn-lang.active")
        ?.getAttribute("data-lang");

      let prefix = "Atualizado às ";
      if (currentLang === "en") prefix = "Updated at ";
      if (currentLang === "es") prefix = "Actualizado a las ";

      elUpdated.dataset.error = "0";
      elUpdated.textContent =
        prefix +
        now.toLocaleTimeString(
          currentLang === "pt" ? "pt-BR" : currentLang === "es" ? "es-ES" : "en-US",
          {
            hour: "2-digit",
            minute: "2-digit"
          }
        );
    } catch (err) {
      console.error("Erro DexScreener:", err);
      const elNative = document.getElementById("price-native");
      const elUsd = document.getElementById("price-usd");
      const elLiq = document.getElementById("liquidity-usd");
      const elVol = document.getElementById("volume-usd");
      const elUpdated = document.getElementById("price-updated");

      if (elNative) elNative.textContent = "Error";
      if (elUsd) elUsd.textContent = "Error";
      if (elLiq) elLiq.textContent = "-";
      if (elVol) elVol.textContent = "-";

      if (elUpdated) {
        const currentLang = document
          .querySelector(".btn-lang.active")
          ?.getAttribute("data-lang");
        elUpdated.dataset.error = "1";
        if (currentLang === "pt") elUpdated.textContent = "Falha ao atualizar";
        else if (currentLang === "es")
          elUpdated.textContent = "Error al actualizar";
        else elUpdated.textContent = "Failed to update";
      }
    }
  }

  fetchPLHPPrice();
  setInterval(fetchPLHPPrice, 60000);
</script>
